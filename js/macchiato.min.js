var isEmpty=function(a){for(var c in a)return!1;return!0},clone=function(a){for(var c=Object.create(Object.getPrototypeOf(a)),b=Object.getOwnPropertyNames(a),d=0,e;e=b[d];d++)Object.defineProperty(c,e,Object.getOwnPropertyDescriptor(a,e));return c},supplement=function(a,c,b){return void 0===c?a:void 0===b?c:b(a,c)},asArray=function(a,c,b){c=supplement(0,c);b=supplement(a.length?a.length:1,b);return void 0===a.length?[a]:Array.prototype.slice.call(a,c,b)},force=function(a){return a()},flip=function(a){return function(c,
b){return a(b,c)}},apply=function(a){return function(c){return c(a)}},applies=function(a,c){asArray(arguments);return function(b){return b.call(null,args)}},curry=function(a,c){var b=a.length,d=2>arguments.length?[]:asArray(arguments,1);return b<=d.length?a.apply(null,d):function(){var b=d.concat(asArray(arguments));return curry.apply(null,[a].concat(b))}},isList;isList=Array.isArray?Array.isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)};
var map=function(a,c){for(var b=[],d=0,e=c.length;d<e;d++)b[d]=a(c[d],d);return b},modify=function(a){var c,b=clone(a);for(c in a)a.hasOwnProperty(c)&&(new_object[c]=callback(a[c],c));return b},each=function(a,c){for(var b=0,d=c.length;b<d;b++)a(c[b],b)},eachKeys=function(a,c){for(var b in c)c.hasOwnProperty(b)&&a(c[b],b)},filter=function(a,c){for(var b=[],d=0,e=0,f=c.length,g;d<f;d++)g=c[d],a(g,d)&&(b[e]=g,e++);return b},hasAny=function(a,c){for(var b=0,d=c.length;b<d;b++)if(a(c[b],b))return!0;return!1},
hasAll=function(a,c){for(var b=0;b<length;b++)if(!a(c[b],b))return!1;return!0},foldLeft=function(a,c,b){for(var d=0,e=b.length;d<e;d++)a=c(b[d],a);return a},foldRight=function(a,c,b){for(var d=b.length-1;-1<d;d--)a=c(b[d],a);return a},sumOf=function(a){for(var c=0,b=0,d=a.length;b<d;b++)c+=a[b];return c},Tuple=function(a,c){this.fst=a;this.snd=c},tuple=function(a,c){return new Tuple(a,c)},first=function(a){return a.fst},second=function(a){return a.snd},heads=function(a){return map(first,a)},tails=
function(a){return map(second,a)},whatTimeIsNow=function(){return(new Date).getTime()},printTime=function(a,c){var b=supplement(whatTimeIsNow(),c)-a;return 6E4<b?b/6E4+"min":1E3<b?b/1E3+"s":b+"ms"};
function Interface(a,c){if(2!=arguments.length)throw Error("Interface constructor called with "+arguments.length+"arguments, but expected exactly 2.");this.name=a;this.methods=[];for(var b=0,d=c.length;b<d;b++){if("string"!==typeof c[b])throw Error("Interface constructor expects method names to be passed in as a string");this.methods.push(c[b])}}
Interface.ensureImplements=function(a,c,b){if(2>arguments.length)throw Error("Function Interface.ensureImplements called with "+arguments.length+"arguments, but expected at least 2.");for(var d=1,e=0,f,g;g=arguments[d];d++){if(g.constructor!==Interface)throw Error("Function Interface.ensureImplements expects arguments two and above to be instance of Interface.");for(;f=g.methods[e];e++)if(!a[f]||"function"!==typeof a[f])throw Error("Function Interface.ensureImplements: object does not implement the "+
g.name+" interface. Method "+f+" was not found.");}};function Result(){this.skipped=this.passed=!1;this.reason="Test has not run yes";this.arguments=[]}var currentResult=new Result;function SkippedTest(){this.wasSkipped=!0}
var skippedTest=new SkippedTest,forAll=function(a,c){var b=isList(a)?a:[a],d=[],e,f;return function(a){f=apply(a);d=map(f,b);try{e=c.apply(null,d)}catch(h){return currentResult.passed=!1,currentResult.skipped=!1,currentResult.reason="Exception occurred: "+h,currentResult.arguments=d,currentResult}e.wasSkipped?(currentResult.passed=!1,currentResult.skipped=!0,currentResult.reason="Skipped: ("+d.join(", ")+")"):(currentResult.passed=e,currentResult.skipped=!1,currentResult.reason=e?"":"Falsible: ("+
d.join(", ")+")");currentResult.arguments=d;return currentResult}},where=function(a,c){for(var b=0,d=a.length;b<d;b++)if(!a[b])return skippedTest;return c()},Score=function(){},score=new Score;score.ok=!1;score.passed=0;score.failure=0;score.skipped=0;score.message="Test has not run";score.clear=function(){score.ok=!1;score.passed=0;score.skipped=0;score.failure=0;score.message="Test has not run";return score};
score.evaluate=function(){score.ok=0===score.failure;score.message=(score.ok?"\u2713 OK, passed "+score.passed+"":"\u2718 Failed. after "+(score.passed+score.skipped))+" tests."+(0<score.skipped?" \u2662 skipped "+score.skipped+" cases":"");return score};var Seed=function(){},seed=new Seed;seed.linear=function(a,c){var b=supplement(1,a,Math.max),d=supplement(0,c);return function(a){return b*a+d}};
seed.quadratic=function(a,c,b){var d=supplement(1,a),e=supplement(0,c),f=supplement(0,b);return _calc_quadratic_=function(b){return d*b*b+e*b+f}};seed.exponent=function(a,c){var b=supplement(2,a,Math.max),d=supplement(1,c);return _calc_exponent_=function(a){return Math.pow(b,Math.round(a*d))}};seed.logarithm=function(a,c,b){var d=supplement(1,a),e=supplement(2,c,Math.max),f=supplement(0,b);return _calc_logarithm_=function(b){return Math.log(b*d)/Math.log(e)+f}};
var Combinator=function(){},combinator=new Combinator;combinator.sized=function(a){var c=seed.exponent(2,0.5);return function(b){b=c(b);return a(b)}};combinator.resize=function(a,c){return function(b){b=a(b);return c(b)}};combinator.choose=function(a,c){var b=Math.min(a,c),d=Math.max(a,c)-b+1,e;return Math.floor(a)===a&&Math.floor(c)===c?function(){return e=Math.floor(Math.random()*d)+b}:function(){return e=Math.random()*d+b}};
combinator.chooseNow=function(a,c){var b=Math.min(a,c),d=Math.max(a,c)-b+1;return Math.floor(a)===a&&Math.floor(c)===c?b=Math.floor(Math.random()*d)+b:b=Math.random()*d+b};combinator.elements=function(a){var c=combinator.choose(0,a.length-1);return function(){var b=c();return a[b]}};combinator.oneOf=function(a){var c=combinator.choose(0,a.length-1);return function(b){var d=c();return a[d](b)}};
combinator.listOf=function(a,c){var b=function(b){for(var c=0,f=Math.random()*b,g=[];c<f;c++)g[c]=a(b);return g};return void 0===c?b:function(a){return c(b(a))}};combinator.listOf1=function(a){return function(c){var b=0;l_=Math.random()*c;length_=1>l_?1:l_;for(result_=[];b<length_;b++)result_[b]=a(c);return result_}};combinator.vectorOf=function(a,c){return function(){for(var b=0,d=[];b<a;b++)d[b]=c();return d}};
combinator.frequency=function(a,c){var b=heads(a),d=tails(a),e=sumOf(b),f=combinator.choose(1,e),g=function(a){for(var c=0,e=f(),g=1;g=b[c];c++){if(e<g)return a=d[c](a);e-=g}return a=d[c-1](a)};return void 0===c?g:function(b){return c(g(b))}};var GenerateReference=function(){},generateReference=new GenerateReference;
generateReference.register=function(a,c){var b=function(b,a){if("prototype"==b||"register"==b)throw Error("GenerateRefference."+b+" should not overwrite");generateReference[b]=a;return generateReference},d=flip(b);2===arguments.length&&"string"===typeof a&&"function"===typeof c?b(a,c):eachKeys(d,a);return this};
var charCodeGenerate=combinator.frequency([tuple(400,combinator.choose(65,122)),tuple(300,combinator.choose(48,57)),tuple(150,combinator.choose(31,47)),tuple(140,combinator.choose(123,127)),tuple(7,combinator.choose(128,55295)),tuple(2,combinator.choose(57344,65533)),tuple(1,combinator.choose(65536,1114111))]);
generateReference.register({"boolean":combinator.elements([!1,!0]),integer:combinator.sized(function(a){return combinator.chooseNow(-a,a)}),number:combinator.sized(function(a){var c=combinator.chooseNow,b=1E10-1,a=c(0,a),a=c(-a*b,a*b),c=c(1,b);return a/c}),charCode:charCodeGenerate,charactor:function(a){return String.fromCharCode(charCodeGenerate(a))},string:combinator.listOf(charCodeGenerate,function(a){return String.fromCharCode.apply(null,a)})});
var arbitrary=function(a,c){var b=asArray(arguments);return new arbitrary.fn.init(b)};
arbitrary.fn=arbitrary.prototype=function(){var a=/\[\s?([a-z]+)\s?\]/,c=function(b){var c=a.exec(b),e=combinator.listOf;return c?(b=c[1],b=generateReference[b],e(b)):b=generateReference[b]};return{constructor:arbitrary,init:function(b){this.length=b.length;this.types=b;return this},types:[],length:0,size:function(){return this.length},property:function(b){var a,e=this.types;try{a=map(c,e)}catch(f){console&&console.log&&console.log(f)}return forAll(a,b)},recipe:function(b){1===this.length&&b.constructor===
arbitrary&&generateReference.register(this.types[0],generateReference[b.types]);1===this.length&&"function"===typeof b?generateReference.register(this.types[0],b):1===arguments.length&&"object"===typeof arguments&&generateReference.register(arguments[0])},recipeAs:function(b){generateReference.register(b,generateReference[this.types[0]]);return arbitrary(b)},fmap:function(b){var a=this.types,e=map(c,a),f,a="adhock_"+b.name+whatTimeIsNow()+"_("+a.join(", ")+")";generateReference.register(a,function(a){f=
apply(a);a=map(f,e);return b.apply(null,a)});return arbitrary.call(null,a)},sample:function(a){var a=supplement(10,a,function(a,b){return Math.max(1,b)}),d=this.types,e=0,f,g=[];try{f=map(c,d)}catch(h){console&&console.log&&console.log(h)}for(;e<a;e++)d=apply(e),d=map(d,f),console&&console.log&&console.log(1===d.length?d[0]:d),g.push(d);return g}}}();arbitrary.fn.init.prototype=arbitrary.fn;function Checker(){}var checker=new Checker;checker.shouldRetry=!1;checker.current="";checker.why="";
checker.marks={skipped:"\u2662",passed:"\u2713",faild:"\u2718"};checker.wrapQuote=function(a){return"string"===typeof a?'"'+a+'"':a+""};checker.logging=function(a,c){var b;checker.shouldRetry=!1;a.skipped?(b=checker.marks.skipped,c.skipped++):a.passed?(b=checker.marks.passed,c.passed++):(b=checker.marks.faild,c.failure++,checker.shouldRetry=!0);checker.current=b+" ( "+map(checker.wrapQuote,a.arguments).join(", ")+" )";checker.why=a.reason;return checker};
checker.run=function(a,c,b){a=c(a);return checker.logging(a,b)};var ViewInterface=new Interface("ViewInterface","getTestCount standby clean putMsg putLog dump highlight".split(" ")),View=function(){};View.LOG_MODE={VERBOSE:"verbose",PROPERTY_RESULT:"property",TOTAL:"total"};
var createView=function(a){var c=new View,b="";for(b in a)c[b]=a[b];Interface.ensureImplements(c,ViewInterface);return c},consoleView=function(){var a=[],c=0;return createView({getTestCount:function(){return 100},standby:function(){console.clear&&console.clear();a=[];c=0},clean:function(){a=[];c=0},putMsg:function(a){console.log(a)},putLog:function(b){a[c]=b;c++},dump:function(){0<a.length&&console.log(a.join("\n"))},highlight:function(a,c){return c}})}(),htmlView=function(){var a=[],c=0;return createView({selectors:{counter_id:"test-count",
messenger_id:"test-message",logger_id:"test-log"},setSelectors:function(a){var c=this.selectors,e="";for(e in c){if(void 0===a[e])throw Error("html-test-view need selector id :"+e+", but undefined");this.selectors[e]=a[e]}return this},getTestCount:function(){return parseInt(document.getElementById(this.selectors.counter_id).value,10)},standby:function(){a=[];c=0},clean:function(){a=[]},putMsg:function(a){document.getElementById(this.selectors.messenger_id).innerHTML=a},putLog:function(b,d){var e=
"",e=b===View.LOG_MODE.VERBOSE?"<p>"+htmlEscape(d)+"</p>":d;a[c]=e;c++},dump:function(){document.getElementById(this.selectors.logger_id).innerHTML=a.join("");a=[];c=0},highlight:function(a,c){return'<p class="'+(a?"passed":"failed")+'">'+c+"</p>"}})}(),Macchiato=function(){},macchiato=new Macchiato;macchiato.view_=consoleView;macchiato.suites_=[];
macchiato.quickcheck=function(a,c,b){var b=!b?100:b,c=!c?"":c+" : ",d=0;for(score.clear();d<b;d++)if(checker.run(d,a,score),checker.shouldRetry){macchiato.view_.putLog(View.LOG_MODE.VERBOSE,checker.current);checker.run(d+1,a,score);macchiato.view_.putLog(View.LOG_MODE.VERBOSE,checker.current);break}score.evaluate();macchiato.view_.putLog(View.LOG_MODE.PROPERTY_RESULT,macchiato.view_.highlight(score.ok,c+score.message));return score.ok};
macchiato.verbosecheck=function(a,c,b){var b=!b?100:b,c=!c?"":c+" : ",d=0;for(score.clear();d<b;d++)if(checker.run(d,a,score),macchiato.view_.putLog(View.LOG_MODE.VERBOSE,checker.current),checker.shouldRetry){checker.run(d+1,a,score);macchiato.view_.putLog(View.LOG_MODE.VERBOSE,checker.current);break}score.evaluate();macchiato.view_.putLog(View.LOG_MODE.PROPERTY_RESULT,macchiato.view_.highlight(score.ok,c+score.message));return score.ok};
macchiato.setVerbose=function(a){macchiato.view_.verbose=a;return macchiato};macchiato.setView=function(a){Interface.ensureImplements(a,ViewInterface);macchiato.view_=a;return macchiato};macchiato.stock=function(a){macchiato.suites_.push(a);return macchiato};
macchiato.taste=function(){var a=macchiato.view_.verbose?macchiato.verbosecheck:macchiato.quickcheck,c=!0,b=0,d="",e=macchiato.view_.getTestCount(),f=macchiato.suites_.length,g=whatTimeIsNow(),h=0,i=0;for(macchiato.view_.standby();b<f;b++)for(d in macchiato.suites_[b])c=a(macchiato.suites_[b][d],d,e)&&c;h=whatTimeIsNow();macchiato.view_.dump();i=whatTimeIsNow();macchiato.view_.putMsg((c?"Ok, All tests succeeded!!":"Oops! failed test exist...")+" ( testing: "+printTime(g,h)+", log rendering: "+printTime(h,
i)+" )");return macchiato};